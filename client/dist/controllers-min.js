"use strict";!function(){function e(e,t,s,o,a,n,r){var u=this;u.logout=function(){u.dataLoading=!0,e.logout({userData:{username:angular.copy(o.userSession.username)}}).then(function(e){e.data.success?(delete o.userSession,t.show(t.simple().textContent("Bye")),o.socket.disconnect(),s.path("/login")):(t.show(t.simple().textContent(e.data.err)),u.dataLoading=!1)},function(e){t.show(t.simple().textContent("Status error: "+e.status+" - "+e.statusText)),u.dataLoading=!1})},u.sendMsg=function(){if(u.message){var e={from:o.userSession.username,message:u.message};o.socket.emit("msg",e),u.messages.push(e),u.message="",n.$digest()}},o.socket.on("welcome",function(e){t.show(t.simple().textContent(e+" has connected to the home."))}),o.socket.on("left",function(e){t.show(t.simple().textContent(e+" has disconnected from the home."))}),o.socket.on("msg",function(e){u.messages.push(e),n.$digest()}),t.show(t.simple().textContent("Welcome "+userSession.username)),u.messages=[]}angular.module("app.home").controller("HomeController",e),e.$inject=["HomeService","$mdToast","$location","$rootScope","$document","$scope","$anchorScroll"]}(),function(){function e(e,t,s,o,a,n,r){var u=this;u.login=function(){u.dataLoading=!0;var i=angular.copy(u.userData);i.password=n.convertToSHA256(i.password);var c=r.encode(i.username+":"+i.password);t.login(c).then(function(t){"success"===t.data.status?(u.userSession=t.data.data,e.userSession=angular.copy(u.userSession),o.path("/home")):(s.show(s.simple().textContent(t.data.data.message)),10006===t.data.data.errorCode?(u.userData.password="",a[0].getElementById("passwordForm").focus()):(u.userData={},a[0].getElementById("usernameForm").focus()),u.dataLoading=!1)},function(e){s.show(s.simple().textContent("Status error: "+e.status+" - "+e.statusText)),u.userData={},a[0].getElementById("usernameForm").focus(),u.dataLoading=!1})},u.register=function(){o.path("/register")},u.dataLoading=!1}angular.module("app.login").controller("LoginController",e),e.$inject=["$rootScope","LoginService","$mdToast","$location","$document","sha256","$base64"]}(),function(){function e(e,t,s,o,a,n){var r=this;r.register=function(){if(r.dataLoading=!0,r.userData.password===r.userData.confirmPassword){var u=angular.copy(r.userData);delete u.confirmPassword,u.password=n.convertToSHA256(u.password),t.register({userData:u}).then(function(t){"success"===t.data.status?(s.show(s.simple().textContent("Account created successfully")),r.userSession=t.data.data,e.userSession=angular.copy(r.userSession),o.path("/home")):(s.show(s.simple().textContent(t.data.data.message)),r.userData={},a[0].getElementById("usernameForm").focus(),r.dataLoading=!1)},function(e){s.show(s.simple().textContent("Status error: "+e.status+" - "+e.statusText)),r.userData={},a[0].getElementById("usernameForm").focus(),r.dataLoading=!1})}else s.show(s.simple().textContent("The password confirmation doesn't match, please try again.")),r.userData.password="",r.userData.confirmPassword="",a[0].getElementById("passwordForm").focus(),r.dataLoading=!1},r.dataLoading=!1}angular.module("app.register").controller("RegisterController",e),e.$inject=["$rootScope","RegisterService","$mdToast","$location","$document","sha256"]}();