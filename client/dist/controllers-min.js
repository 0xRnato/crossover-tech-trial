"use strict";!function(){function e(e,t,o,s,a,n,r,i,u){var c=this,d=void 0;c.logout=function(e){c.dataLoading=!0,delete s.userSession,e?(a.emit("forceLogout",d.userObject.username),r.location.reload()):(t.show(t.simple().textContent("Bye")),a.emit("logout",d.userObject.username),r.location.reload())},c.sendMsg=function(){if(c.message){var e={from:s.userSession.username,message:c.message};a.emit("msg",e),c.messages.push(e),c.message="",i.$digest()}},a.on("welcome",function(e){t.show(t.simple().textContent(e+" has connected to the auction."))}),a.on("left",function(e){t.show(t.simple().textContent(e+" has disconnected from the auction."))}),a.on("alreadyLogged",function(){t.show(t.simple().textContent("This account has been logged in another place, so let's close this section.")),c.logout(!0)}),a.on("msg",function(e){c.messages.push(e),i.$digest()}),d=s.userSession,t.show(t.simple().textContent("Welcome "+d.userObject.username)),a.emit("login",d.userObject.username),c.messages=[]}angular.module("app.home").controller("HomeController",e),e.$inject=["HomeService","$mdToast","$location","$rootScope","socket","$document","$window","$scope","$anchorScroll"]}(),function(){function e(e,t,o,s,a,n,r){var i=this;i.login=function(){i.dataLoading=!0;var u=angular.copy(i.userData);u.password=n.convertToSHA256(u.password);var c=r.encode(u.username+":"+u.password);t.login(c).then(function(t){"success"===t.data.status?(i.userSession=t.data.data,e.userSession=angular.copy(i.userSession),s.path("/home")):(o.show(o.simple().textContent(t.data.data.message)),10006===t.data.data.errorCode?(i.userData.password="",a[0].getElementById("passwordForm").focus()):(i.userData={},a[0].getElementById("usernameForm").focus()),i.dataLoading=!1)},function(e){o.show(o.simple().textContent("Status error: "+e.status+" - "+e.statusText)),i.userData={},a[0].getElementById("usernameForm").focus(),i.dataLoading=!1})},i.register=function(){s.path("/register")},i.dataLoading=!1}angular.module("app.login").controller("LoginController",e),e.$inject=["$rootScope","LoginService","$mdToast","$location","$document","sha256","$base64"]}(),function(){function e(e,t,o,s,a,n){var r=this;r.register=function(){if(r.dataLoading=!0,r.userData.password===r.userData.confirmPassword){var i=angular.copy(r.userData);delete i.confirmPassword,i.password=n.convertToSHA256(i.password),t.register({userData:i}).then(function(t){"success"===t.data.status?(o.show(o.simple().textContent("Account created successfully")),r.userSession=t.data.data,e.userSession=angular.copy(r.userSession),s.path("/home")):(o.show(o.simple().textContent(t.data.data.message)),r.userData={},a[0].getElementById("usernameForm").focus(),r.dataLoading=!1)},function(e){o.show(o.simple().textContent("Status error: "+e.status+" - "+e.statusText)),r.userData={},a[0].getElementById("usernameForm").focus(),r.dataLoading=!1})}else o.show(o.simple().textContent("The password confirmation doesn't match, please try again.")),r.userData.password="",r.userData.confirmPassword="",a[0].getElementById("passwordForm").focus(),r.dataLoading=!1},r.dataLoading=!1}angular.module("app.register").controller("RegisterController",e),e.$inject=["$rootScope","RegisterService","$mdToast","$location","$document","sha256"]}();